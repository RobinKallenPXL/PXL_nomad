log_level = "DEBUG"

data_dir = "/opt/nomad/server" 
bind_addr = "{{ ansible_eth1.ipv4.address }}" 


{% if nomad__server == "true" -%}
# enable the server
advertise {
  # Defaults to the first private IP address.
  http = "{{ ansible_eth1.ipv4.address }}"
  rpc  = "{{ ansible_eth1.ipv4.address }}"
  serf = "{{ ansible_eth1.ipv4.address }}"
} 
server {
    enabled = {{nomad__server}}

    #self-elect
   
    bootstrap_expect = 1    
}

{% else -%}

name = "{{ inventory_hostname_short }}"

client {
        enabled = true
                servers = ["192.168.1.4:4647"] 
        network_interface = "eth1" 
}
ports {
        http = 5656
plugin "docker" {
        config{
                gc {
                        dangling_containers {
                                enabled=false
                        }
                }
        }
}
{% endif -%}
